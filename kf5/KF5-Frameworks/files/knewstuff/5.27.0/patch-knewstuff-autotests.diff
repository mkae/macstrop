--- autotests/orig.CMakeLists.txt	2015-11-08 13:30:13.000000000 +0100
+++ autotests/CMakeLists.txt	2015-12-06 22:32:26.000000000 +0100
@@ -1,4 +1,5 @@
 include(ECMMarkAsTest)
+include(ECMMarkNonGuiExecutable)
 
 find_package(Qt5Test ${REQUIRED_QT_VERSION} NO_MODULE REQUIRED)
 set_package_properties(Qt5Test PROPERTIES
@@ -13,6 +13,7 @@
 macro(knewstuff_unit_tests)
     foreach(_testname ${ARGN})
        add_executable(${_testname} ${_testname}.cpp ../src/core/author.cpp ../src/core/entryinternal.cpp ../src/entry.cpp ../src/core/xmlloader.cpp  ../src/knewstuff_debug.cpp)
+       ecm_mark_nongui_executable(${_testname})
        # fake static linking to prevent the export macros on windows to kick in.
        set_target_properties(${_testname} PROPERTIES COMPILE_FLAGS -DKNEWSTUFF_STATIC_DEFINE)
        add_test("knewstuff-${_testname}" ${_testname})
@@ -28,6 +29,7 @@
 
 # KMoreTools:
 add_executable(kmoretoolstest kmoretools/kmoretoolstest.cpp ../src/knewstuff_debug.cpp)
+ecm_mark_nongui_executable(kmoretoolstest)
 add_test(kmoretoolstest kmoretoolstest)
 ecm_mark_as_test(kmoretoolstest)
 target_link_libraries(kmoretoolstest Qt5::Test Qt5::Widgets KF5::NewStuff KF5::I18n)
